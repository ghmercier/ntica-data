<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction à QGIS – Supports pédagogiques du module NTICA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter1.html" rel="next">
<link href="../chapters/outils-quotidiens.html" rel="prev">
<link href="../resources/profile/logo-enpc-ip-rvb_vertical.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-533b9ae3c010999c496e3372658dddf2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-533b9ae3c010999c496e3372658dddf2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-533b9ae3c010999c496e3372658dddf2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/qgis-intro.html">Introduction à QGIS</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../resources/profile/logo-enpc-ip-rvb_vertical.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../resources/profile/logo-enpc-ip-rvb_vertical.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accueil</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/outils-quotidiens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Les outils du quotidien</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/qgis-intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction à QGIS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Premiers pas en CSV</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#création-du-projet" id="toc-création-du-projet" class="nav-link active" data-scroll-target="#création-du-projet">Création du projet</a></li>
  <li><a href="#ajout-dun-fond-de-carte" id="toc-ajout-dun-fond-de-carte" class="nav-link" data-scroll-target="#ajout-dun-fond-de-carte">Ajout d’un fond de carte</a></li>
  <li><a href="#ajout-dune-première-couche-vectorielle" id="toc-ajout-dune-première-couche-vectorielle" class="nav-link" data-scroll-target="#ajout-dune-première-couche-vectorielle">Ajout d’une première couche vectorielle</a></li>
  <li><a href="#transparence-du-fond-de-plan" id="toc-transparence-du-fond-de-plan" class="nav-link" data-scroll-target="#transparence-du-fond-de-plan">Transparence du fond de plan</a></li>
  <li><a href="#exploration-des-données" id="toc-exploration-des-données" class="nav-link" data-scroll-target="#exploration-des-données">Exploration des données</a></li>
  <li><a href="#sélection-manuelle-de-données" id="toc-sélection-manuelle-de-données" class="nav-link" data-scroll-target="#sélection-manuelle-de-données">Sélection manuelle de données</a></li>
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link" data-scroll-target="#statistiques-descriptives">Statistiques descriptives</a></li>
  <li><a href="#premiers-calculs-géométriques" id="toc-premiers-calculs-géométriques" class="nav-link" data-scroll-target="#premiers-calculs-géométriques">Premiers calculs géométriques</a></li>
  <li><a href="#affichage-par-catégories" id="toc-affichage-par-catégories" class="nav-link" data-scroll-target="#affichage-par-catégories">Affichage par catégories</a></li>
  <li><a href="#sélection-avancée-de-données" id="toc-sélection-avancée-de-données" class="nav-link" data-scroll-target="#sélection-avancée-de-données">Sélection avancée de données</a>
  <ul class="collapse">
  <li><a href="#sélection-par-attributs" id="toc-sélection-par-attributs" class="nav-link" data-scroll-target="#sélection-par-attributs">Sélection par attributs</a></li>
  <li><a href="#sélection-par-géométrie" id="toc-sélection-par-géométrie" class="nav-link" data-scroll-target="#sélection-par-géométrie">Sélection par géométrie</a></li>
  </ul></li>
  <li><a href="#export-vers-une-nouvelle-couche" id="toc-export-vers-une-nouvelle-couche" class="nav-link" data-scroll-target="#export-vers-une-nouvelle-couche">Export vers une nouvelle couche</a></li>
  <li><a href="#jointure-attributaire" id="toc-jointure-attributaire" class="nav-link" data-scroll-target="#jointure-attributaire">Jointure attributaire</a></li>
  <li><a href="#affichage-gradué" id="toc-affichage-gradué" class="nav-link" data-scroll-target="#affichage-gradué">Affichage gradué</a></li>
  <li><a href="#mise-en-page-et-export" id="toc-mise-en-page-et-export" class="nav-link" data-scroll-target="#mise-en-page-et-export">Mise en page et export</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ghmercier/ntica-data/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction à QGIS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Nous allons créer sans attendre notre première carte : un fond de plan cartographique centré sur la CA Paris Vallée de la Marne, sur lequel nous allons superposer des couches vectorielles de description administrative du territoire.</p>
<section id="création-du-projet" class="level2">
<h2 class="anchored" data-anchor-id="création-du-projet">Création du projet</h2>
<p>Lancer QGIS, créer un nouveau projet.</p>
<ol type="1">
<li><strong>Projet → Nouveau</strong></li>
</ol>
</section>
<section id="ajout-dun-fond-de-carte" class="level2">
<h2 class="anchored" data-anchor-id="ajout-dun-fond-de-carte">Ajout d’un fond de carte</h2>
<p>Ajouter le fond de carte OpenStreetMap.</p>
<ol type="1">
<li><strong>Couche → Ajouter une couche → Ajouter une couche XYZ</strong></li>
<li><strong>Connexions XYZ → OpenStreetMap</strong></li>
<li><strong>Ajouter</strong></li>
</ol>
<p>Dans le coin inférieur droit, remarquez qu’un <abbr title="Système de coordonnées de référence">SCR</abbr> a été automatiquement défini : EPSG:3857. C’est celui de la première couche ajoutée. Si nous devions ajouter des couches exprimées dans un autre SCR, QGIS ferait la conversion de manière transparente, à condition qu’il puisse déterminer sans ambiguité le SCR de la couche fournie.</p>
<details>
<summary>
SCR, Késako ?
</summary>
Un système de coordonnées de référence est le référentiel qui donne du sens aux valeurs numériques que prennent des coordonnées géographiques (latitude, longitude, altitude). On pourra se référer utilement à la <a href="https://docs.qgis.org/3.40/fr/docs/user_manual/working_with_projections/working_with_projections.html">documentation</a>. de QGIS.
</details>
<p><img src="../resources/intro-qgis/1_scr.jpg" class="img-fluid"></p>
</section>
<section id="ajout-dune-première-couche-vectorielle" class="level2">
<h2 class="anchored" data-anchor-id="ajout-dune-première-couche-vectorielle">Ajout d’une première couche vectorielle</h2>
<p>Télécharger la <a href="ade_simplifiee.gpkg">géodatabase</a> préparée spécialement pour ce TP. Elle contient quelques données issues de la base <a href="https://geoservices.ign.fr/adminexpress">AdminExpress</a> de l’IGN.</p>
<details>
<summary>
Géodatabase, ESRI Shapefile ?
</summary>
Plusieurs formats existent pour stocker de l’information géographique. QGIS travaille par défaut avec des géodatabases. Vous trouverez souvent des fichiers au format ESRI Shapefile. On retiendra qu’une géodatabase (extension <code>gpkg</code>) est capable de stocker plusieurs couches dans un même fichier, alors que le format ESRI Shapefile (extension principale <code>shp</code>) crée six différents fichiers pour stocker l’information d’une seule couche vectorielle. Pour les détails techniques, se référer à la <a href="https://docs.qgis.org/3.40/fr/docs/user_manual/managing_data_source/supported_data.html#geopackage">documentation</a>.
</details>
<p>Ajouter la couche <code>communes</code> contenue dans la Géodatabase.</p>
<ol type="1">
<li><strong>Couche → Ajouter une couche → Ajouter une couche vecteur</strong></li>
<li><strong>Source → Jeux de données vectorielles</strong></li>
<li>Aller chercher le ficher <code>ade_simplifie.gpkg</code></li>
<li>Dans la fenêtre qui s’affiche, sélectionner la couche <code>commune</code></li>
</ol>
<p><img src="../resources/intro-qgis/2_communes.jpg" class="img-fluid"></p>
<p>On va modifier la symbologie de la couche pour ne conserver que les contours de chaque objet, sans ce vilain fond opaque, puis ajouter des étiquettes donnant le nom de la commune (on pourra personnaliser la police et le corps).</p>
<p>Avec la couche sélectionnée :</p>
<ol type="1">
<li><strong>Couche → Propriétés de la couche</strong></li>
<li><strong>Symbologie → Remplissage simple → Style de remplissage → Pas de remplissage</strong></li>
<li><strong>Étiquettes → Étiquettes simples → Valeur → <code>nom_officiel</code></strong></li>
</ol>
</section>
<section id="transparence-du-fond-de-plan" class="level2">
<h2 class="anchored" data-anchor-id="transparence-du-fond-de-plan">Transparence du fond de plan</h2>
<p>Pour mieux voir nos entités vectorielles, on peut rendre le fond de plan transparent et le passer en niveau de gris.</p>
<p>Avec la couche sélectionnée :</p>
<ol type="1">
<li><strong>Couche → Propriétés de la couche</strong></li>
<li><strong>Transparence → Opacité globale → 50%</strong></li>
<li><strong>Symbologie → Rendu de couche → Niveaux de gris → [Par clarté]</strong></li>
</ol>
<p><img src="../resources/intro-qgis/3_fond_plan.jpg" class="img-fluid"></p>
</section>
<section id="exploration-des-données" class="level2">
<h2 class="anchored" data-anchor-id="exploration-des-données">Exploration des données</h2>
<p>À chaque objet de la couche <code>communes</code> correspondent des données. On peut les afficher pour un objet donné avec l’outil <strong>Identifier des données</strong> accessible par la barre d’outils. Pour les communes, un champ important est le <code>code_insee</code>. C’est lui qui identifie la commune de manière unique, on en aura besoin ultérieurement.</p>
<details>
<summary>
De l’importance des métadonnées
</summary>
Même si les intitulés des champs sont ici clairs, il est de bonne pratique de toujours consulter les métadonnées d’une source de données pour s’assurer d’avoir bien tout compris. Dans le cas présent, on ira voir sur le <a href="https://geoservices.ign.fr/documentation/donnees/vecteur/adminexpress">site de l’IGN</a>, à la page ADMIN Express.
</details>
<p><img src="../resources/intro-qgis/4_metadonnees.jpg" class="img-fluid"></p>
<p>Une autre manière d’explorer la couche est d’afficher sa table d’attributs (<kbd>F6</kbd>).</p>
<ol type="1">
<li><strong>Couche → Ouvrir la table d’attributs</strong></li>
</ol>
</section>
<section id="sélection-manuelle-de-données" class="level2">
<h2 class="anchored" data-anchor-id="sélection-manuelle-de-données">Sélection manuelle de données</h2>
<p>On peut sélectionner manuellement une ou plusieurs entités à l’aide de l’outil de la barre des tâches.</p>
<p>Noter dans le menu déroulant les modes de sélections possibles: rectangle de sélection, polygone, main levée, par rayon.</p>
<p>Noter les raccourcis-claviers utiles. Pour ajouter des objets à la sélection courante, maintenir <kbd>SHIFT</kbd>. Pour retrancher des objets à la sélection courante, maintenir <kbd>CTRL</kbd>.</p>
<p>Sélectionner les trois communes de Champs-sur-Marne, Noisiel et Émerainville.</p>
<p><img src="../resources/intro-qgis/5_selection_manuelle.jpg" class="img-fluid"></p>
</section>
<section id="statistiques-descriptives" class="level2">
<h2 class="anchored" data-anchor-id="statistiques-descriptives">Statistiques descriptives</h2>
<p>On peut calculer aisément certains agrégats (moyenne, médiane, etc.) sur les attributs des entités sélectionnés.</p>
<ol type="1">
<li><strong>Vue → Résumé statistique</strong></li>
</ol>
<details>
<summary>
Quelle est la population totale de ces trois communes ?
</summary>
50 124 habitants (au 1er janvier 2022).
</details>
<details>
<summary>
Quelle est la superficie cadastrale totale de ces trois communes ?
</summary>
1 710 hectares.
</details>
<p><img src="../resources/intro-qgis/6_statistiques.jpg" class="img-fluid"></p>
</section>
<section id="premiers-calculs-géométriques" class="level2">
<h2 class="anchored" data-anchor-id="premiers-calculs-géométriques">Premiers calculs géométriques</h2>
<p>Un SIG est capable de calculer la superficie de chaque polygone. On va vérifier que la superficie calculée est cohérente avec la superficie cadastrale renseignée dans la table attributaire.</p>
<p>Ouvrir la table d’attributs (<kbd>F6</kbd>), puis la calculatrice de champs (bouton en forme de boulier dans la barre d’outils, également <kbd>CTRL</kbd>+<kbd>I</kbd>).</p>
<p>Dans la fenêtre qui s’ouvre : * Indiquer le nom du champ à créer (on peut l’appeler <code>superficie</code>) * Sélectionner la case <code>champ virtuel</code> (ie. le champ ne sera pas persistent) * Indiquer le type du champ (<code>entier</code>) * Renseigner la formule pour calculer le champ : area(<span class="citation" data-cites="geometry">@geometry</span>) * Valider</p>
<details>
<summary>
Quelle sera l’unité du champ <code>superficie</code> ?
</summary>
Il dépend bien sûr de l’unité employée par le SCR de la carte. Pour le nôtre, c’est le mètre. Le champ <code>superficie</code> sera donc exprimé en mètres-carrés. On pourra diviser par 10000 pour le convertir en hectares.
</details>
<p><img src="../resources/intro-qgis/7_superficie.jpg" class="img-fluid"></p>
<p>Le champ <code>superficie</code> figure bien désormais dans la table attributaire. On peut calculer la superficie des trois communes de la même manière qu’on a calculé celle de la population.</p>
<details>
<summary>
Quelle est la superficie calculée totale de ces trois communes ?
</summary>
1 737,29 ha. L’écart est de 17,29 ha avec la superficie cadastrale, marge &lt;1%.
</details>
<p>On peut également utiliser l’outil de mesure de longueur (<kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>M</kbd>) ou d’aires (<kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>J</kbd>) pour des calculs ponctuels sur la carte.</p>
</section>
<section id="affichage-par-catégories" class="level2">
<h2 class="anchored" data-anchor-id="affichage-par-catégories">Affichage par catégories</h2>
<p>On va désormais colorer les communes différemment en fonction de l’EPCI auquel elles appartiennent.</p>
<ol type="1">
<li><strong>Couche → Propriétés de la couche → Symbologie → [catégorisé]</strong></li>
<li><strong>Valeur → [codes_siren_des_epci]</strong></li>
<li><strong>Symboles → Remplissage simple → Style de remplissage → [continue]</strong></li>
<li>Bouton <strong>Classer</strong></li>
<li>Bouton <strong>Appliquer</strong></li>
</ol>
<p>On voit nettement se dessiner les 7 EPCI présents dans la base.</p>
<p><img src="../resources/intro-qgis/8_epci.jpg" class="img-fluid"></p>
<details>
<summary>
Millefeuille administratif ?
</summary>
Vous noterez dans la légende que le champ <code>codes_siren_des_epci</code> contient parfois deux numéros SIREN : certaines communes appartient bien à deux EPCI en même temps (Métropole du Grand Paris + EPT).
</details>
</section>
<section id="sélection-avancée-de-données" class="level2">
<h2 class="anchored" data-anchor-id="sélection-avancée-de-données">Sélection avancée de données</h2>
<p>On va désormais sélectionner toutes les communes appartenant à la CA Paris Vallée de la Marne en testant deux méthodes.</p>
<section id="sélection-par-attributs" class="level3">
<h3 class="anchored" data-anchor-id="sélection-par-attributs">Sélection par attributs</h3>
<p>On peut sélectionner l’ensemble des entités de la couche des communes dont le champ <code>code_siren_des_epci</code> contient la valeur <code>200057958</code> grâce à la sélection par expression (<kbd>CTRL</kbd>+<kbd>F3</kbd>)</p>
<ol type="1">
<li><strong>Éditer → Sélection → Sélectionner des entités à l’aide d’une sélection</strong></li>
<li><strong>Expression → [“codes_siren_des_epci” = ‘200057958’]</strong></li>
</ol>
<p><img src="../resources/intro-qgis/9_select_attr.jpg" class="img-fluid"></p>
</section>
<section id="sélection-par-géométrie" class="level3">
<h3 class="anchored" data-anchor-id="sélection-par-géométrie">Sélection par géométrie</h3>
<p>On peut aussi sélectionner l’ensemble des entités de la couche des communes qui sont situées <em>à l’intérieur</em> du polygone représentant la CA Paris Vallée de la Marne dans la couche des EPCI.</p>
<p>Pour cela, on va ajouter la couche vectorielle des EPCI qui figure dans la même géodatabase que la couche des communes et lui appliquer le style qui convient. Pour cela, se référer au début du TD.</p>
<p>Sélectionner ensuite le polygone représentant la CA Paris Vallée de la Marne.</p>
<ol type="1">
<li><strong>Vecteur → Outils de recherche → Sélection par localisation</strong></li>
<li><strong>Sélectionner les entités depuis → <code>ade_simplifiee - communes</code></strong></li>
<li><strong>Où les entités → <code>est à l'intérieur</code></strong></li>
<li><strong>En comparant les entité de → <code>ade_simplifiee - epci</code></strong></li>
<li>cocher la case <code>entités sélectionnées uniquement</code></li>
</ol>
<p><img src="../resources/intro-qgis/10_select_geo.jpg" class="img-fluid"></p>
</section>
</section>
<section id="export-vers-une-nouvelle-couche" class="level2">
<h2 class="anchored" data-anchor-id="export-vers-une-nouvelle-couche">Export vers une nouvelle couche</h2>
<p>Créons maintenant un couche contenant uniquement les 12 communes de la CA Paris Vallée de la Marne. On sauvegardera cette couche dans notre géodatabase initiale.</p>
<ol type="1">
<li><strong>Panneau des couches → </strong> clic-droit couche <code>communes</code></li>
<li><strong>Exporter → Sauvegarder les entités sélectionnées sous</strong></li>
</ol>
<p><img src="../resources/intro-qgis/11_export.jpg" class="img-fluid"></p>
</section>
<section id="jointure-attributaire" class="level2">
<h2 class="anchored" data-anchor-id="jointure-attributaire">Jointure attributaire</h2>
<p>Représentons désormais les différences de population entre les communes.</p>
<p>On serait tenté de faire varier les couleurs des polygones du plus clair au plus foncé&nbsp;: les géomaticiens appellent ces cartes des <em>cartes teintées</em>, ou <em>cartes choroplèthes</em>. Mais pas de choroplèthes avec des données stock… on fera donc varier la taille de points représentant les communes.</p>
<p>Dans la géodatabase initiale, charger la couche <code>chef_lieu_de_commune</code>. Elle contient un semis de points, un pour chaque chef-lieu (c’est-à-dire la mairie).</p>
<p>Ouvrir la table attributaire : constater qu’il y a bien un champ <code>code_insee_de_la_commune</code>, mais pas (encore) de champ <code>population</code>… Qu’à cela ne tienne : on va l’ajouter, en joignant la table des chefs-lieux des communes à celle des communes.</p>
<p>Avec la couche des chefs-lieux sélectionnés :</p>
<ol type="1">
<li><strong>Couche → Propriétés de la couche → Jointures</strong></li>
<li>Cliquer le bouton <kbd>+</kbd></li>
<li><strong>Joindre la couche → <code>ade_simplifiee - communes</code>, <code>ade_simplifie</code></strong></li>
<li><strong>Champ de jointure → <code>code_insee</code></strong></li>
<li><strong>Champ dans la couche cible → <code>code_insee_de_la_commune</code></strong></li>
<li><strong>Champs joints → <code>population</code></strong></li>
</ol>
<p><img src="../resources/intro-qgis/12_jointure.jpg" class="img-fluid"></p>
</section>
<section id="affichage-gradué" class="level2">
<h2 class="anchored" data-anchor-id="affichage-gradué">Affichage gradué</h2>
<p>On peut désormais modifier la symbologie et faire varier la taille des points en fonction de la valeur du champ population.</p>
<ol type="1">
<li><strong>Couche → Propriétés de la couche → Symbologie</strong></li>
<li>Sélectionner <code>gradué</code></li>
<li><strong>Valeur → <code>xxx_population</code></strong></li>
<li><strong>Méthode → Taille</strong></li>
<li><strong>Mode → intervalle égal</strong></li>
</ol>
<details>
<summary>
Discrétisation
</summary>
On comprend bien que le choix des seuils, du nombre de catégories, etc. est stratégique, et qu’on peut faire dire à des mêmes données des choses très différentes selon les choix opérés…
</details>
<p><img src="../resources/intro-qgis/13_gradue.jpg" class="img-fluid"></p>
</section>
<section id="mise-en-page-et-export" class="level2">
<h2 class="anchored" data-anchor-id="mise-en-page-et-export">Mise en page et export</h2>
<p>Exportons notre carte en PDF. Il faut pour cela créer une mise en page.</p>
<ol type="1">
<li><strong>Projet → Nouvelle mise en page</strong></li>
</ol>
<p>Dans la fenêtre qui s’ouvre : * Insérer un bloc carte * Insérer un bloc de texte pour le titre * Insérer un bloc légende * Insérer une échelle graphique * Insérer une flèche indiquant le nord * …</p>
<p>Une fois tous les paramètres ajustés, exporter la carte en PDF.</p>
<p><img src="../resources/intro-qgis/14_mise_en_page.jpg" class="img-fluid"></p>
<p><img src="../resources/intro-qgis/15_export.jpg" class="img-fluid"></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ghmercier\.github\.io\/ntica-data");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/outils-quotidiens.html" class="pagination-link" aria-label="Les outils du quotidien">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Les outils du quotidien</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter1.html" class="pagination-link" aria-label="Premiers pas en CSV">
        <span class="nav-page-text">Premiers pas en CSV</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ghmercier/ntica-data/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>